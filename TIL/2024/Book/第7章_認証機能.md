# 第 7 章 認証機能

- Google 認証機能(OAuth2.0)

  - 機密情報のクライアント ID/クライアントシークレットは公開リポジトリにコミットしてしまうと悪用されてしまうリスクがある
  - .env ファイルに環境変数として記述して、.env ファイルを gitignore してコミットしないようにする
    - 開発者ごとに設定するべき環境変数

- .env ファイルのロード優先順位
  - 1 から順番に優先順位が高く、すでに存在しているプロパティは上書きされない
  1. 環境変数が process.env に設定される
  2. .env.development.local ファイル
  3. .envlocal ファイル
  4. .env.development ファイル
  5. .env ファイル

## 7.1 環境変数の公開範囲

- ブラウザ向けの JavaScript に「値」がバンドルされると、不特定多数のユーザーに「値」が配信されてしまう

  - 機密情報にあたる環境変数はブラウザ向けのバンドルに含めるべきではない

- Public な環境変数
  - Anakytics ログ ID は機密性が低い ID
  - `NEXT_PUBLIC_`という接頭辞がついた環境変数を Next.js はブラウザ向けにインライン化しても問題ない Public な環境変数とみなす
- Private な環境変数
  - `NEXT_PUBLIC_`という接頭辞がない環境変数は Private として扱われる
    - Private な環境変数はバンドルされるタイミングで空文字に置き換えられる

## 7.2 OAuth クライアントの作成

- Google OAuth2.0 認証

  - 外部サーバーリソースにアクセスするために「認可サーバー」を経由して権限を付与する仕組みのこと

- GCP でプロジェクトの作成をする
  - OAuth 同意画面で設定を行う
  - 認証情報で OAuth 2.0 クライアント ID の作成を行う
    - クライアント ID とクライアントシークレットの機密情報をコピーして、.env に貼る
